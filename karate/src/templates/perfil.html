{% extends 'base.html' %}

{% block title %}
Perfile-Student
{% endblock %}

{% block body %}

{% if alumno != None %}
<div class="container-fluid bg-black">
    <div class="row">
        <div class="col-5 g-0">

            <div class="bg-white px-4 py-3">
                <div class="card-body">
                    <!--IMAGEN Y NOMBRE-->
                    <div class="mb-2 text-center card p-3 rounded-5 shadow-lg">
                        <div class="d-flex justify-content-center p-2">
                            <img src="{{url_for('static', filename='img/user_icon.svg')}}" class="img-circle bg-white border border-5 scale-anim" alt="Ícono del usuario" width="150" height="150">
                        </div>
                        <h3 class="card-title text-center lh-1">{{alumno.Nombres}} {{alumno.Ap_pat}} {{alumno.Ap_mat}}</h3>
                    </div>

                    <!--CINTA-Y-DATOS-->
                    <div class="row row-cols-2 flex-row-reverse mb-2">
                        <!--CINTURÓN ACTUAL-->
                        <div class="col-4">
                            <div class="card p-3 rounded-5 shadow-lg h-100 d-flex justify-content-evenly">
                                {% if alumno.ID_cinta == 1 %}
                                <span class="bg-white rounded-pill fs-5 border border-3 scale-anim shadow-sm">Cinturón</span>
                                {% elif alumno.ID_cinta == 2 %}
                                <span class="badge bg-warning rounded-pill fs-5 border-warning-subtle border-3 scale-anim shadow-sm">Cinturón</span>
                                {% elif alumno.ID_cinta == 3 %}
                                <span class="badge rounded-pill fs-5 border-3 scale-anim shadow-sm" style="background-color: rgb(255, 110, 0); border-color: rgb(255, 180, 0);">Cinturón</span>
                                {% elif alumno.ID_cinta == 4 %}
                                <span class="badge rounded-pill fs-5 border-3 scale-anim shadow-sm" style="background-color: rgb(150, 0, 180); border-color: rgb(179, 0, 215);">Cinturón</span>
                                {% elif alumno.ID_cinta == 5 %}
                                <span class="badge bg-primary rounded-pill fs-5 border-primary-subtle border-3 scale-anim shadow-sm">Cinturón</span>
                                {% elif alumno.ID_cinta == 6 %}
                                <span class="badge bg-success rounded-pill fs-5 border-success-subtle border-3 scale-anim shadow-sm">Cinturón</span>
                                {% elif alumno.ID_cinta == 7 %} {# Café #}
                                <span class="badge rounded-pill fs-5 border-3 scale-anim shadow-sm" style="background-color: rgb(70, 50, 40); border-color: rgb(80, 60, 50);">Cinturón</span>
                                {% elif alumno.ID_cinta == 8 %}
                                <span class="w-100 badge bg-danger rounded-pill fs-5 border-danger-subtle border-3 scale-anim shadow-sm">Cinturón</span>
                                {% elif alumno.ID_cinta == 9 %}
                                <span class="badge bg-dark rounded-pill fs-5 border-light-subtle border-3 scale-anim shadow-sm">Cinturón</span>
                                {% endif %}
                                
                                {% set imgCinta = 'Cinta'~alumno.ID_cinta %}
                                <div class="d-flex justify-content-center p-2  ">
                                    <img src="{{url_for('static', filename='img/cintas/' ~ imgCinta ~ '.png')}}" alt="Cinta del alumno" class="img-circle bg-white border border-5 scale-anim shadow-sm" width="125">
                                </div>
                                <!--BOTON-EDITAR-->
                                <div class="mb-1 mt-auto mx-auto">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <button class="btn btn-primary rounded-3">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up" viewBox="0 0 16 16">
                                                    <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5"/>
                                                </svg>
                                                <strong>Cambiar</strong>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--DATOS PERSONALES-->
                        <div class="col-8">
                            <div class="card list-group p-2 rounded-5 shadow-lg h-100">
                                <div class="my-2">
                                    <h4 class="text-center">Datos del alumno</h4>
                                </div>
                                <!--ESTATUS-->
                                {% if alumno.Estatus == 'ACTIVO' %}
                                    {% set classes='bg-success border-success-subtle' %}
                                    {% set mensaje='El alumno se encuentra al día con sus pagos.' %}
                                    {% set classesMensaje='text-success' %}
                                {% elif alumno.Estatus == 'PENDIENTE' %}
                                    {% set classes='bg-warning border-warning-subtle' %}
                                    {% set mensaje='No podrá asistir a más clases hasta realizar los pagos pendientes.' %}
                                    {% set classesMensaje='text-warning' %}
                                {% else %}
                                    {% set classes='bg-danger border-danger-subtle' %}
                                    {% set mensaje='Ya no es alumno del dojo.' %}
                                    {% set classesMensaje='text-danger' %}
                                {% endif %}
                                <div class="list-group-item mb-1">
                                    <div class="container-fluid">
                                        <div class="row row-cols-2">
                                            <div class="col text-wrap p-0">
                                                <p class="my-0 fs-6 fw-semibold">Estatus</p>
                                            </div>
                                            <div class="col">
                                                <span class="badge rounded-pill border border-3 scale-anim w-100 h-100 {{classes}}">{{ alumno.Estatus }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="list-group-item mb-1">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col text-center p-0 {{classesMensaje}}">
                                                {{mensaje}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--FECHA DE NACIMIENTO-->
                                <div class="list-group-item mb-1">
                                    <div class="container-fluid">
                                        <div class="row row-cols-2">
                                            <div class="col text-wrap p-0">
                                                <p class="my-0 fs-6 fw-semibold">Fecha de nacimiento</p>
                                            </div>
                                            <div class="col">
                                                <p class="my-0">{{ '%02d'|format(alumno.Dia|int) }}-{{ alumno.Mes|lower }}-{{ alumno.Anio }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--EDAD-->
                                <div class="list-group-item mb-1">
                                    <div class="container-fluid ">
                                        <div class="row row-cols-2">
                                            <div class="col text-wrap p-0">
                                                <p class="my-0 fs-6 fw-semibold">Edad</p>
                                            </div>
                                            <div class="col">
                                                <p class="my-0">{{ alumno.Edad }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--TELEFONO-->
                                <div class="list-group-item mb-1">
                                    <div class="container-fluid ">
                                        <div class="row row-cols-2">
                                            <div class="col text-wrap p-0">
                                                <p class="my-0 fs-6 fw-semibold">Teléfono</p>
                                            </div>
                                            <div class="col">
                                                <p class="my-0">{{ alumno.Telefono }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--ATISTENCIAS-->
                                <div class="list-group-item mb-1">
                                    <div class="container-fluid ">
                                        <div class="row row-cols-2">
                                            <div class="col text-wrap p-0">
                                                <p class="my-0 fs-6 fw-semibold">Total de asistencias</p>
                                            </div>
                                            <div class="col">
                                                <p class="my-0">{{ alumno.Total_asistencias }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--BOTON-EDITAR-->
                                <div class="mb-1 mt-2">
                                    <div class="container ">
                                        <div class="row">
                                            <button class="btn btn-primary rounded-3">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-lines-fill" viewBox="0 0 16 16">
                                                    <path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z"/>
                                                </svg>
                                                <strong>Editar datos</strong>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--CARD-DERECHA-->
        <div class="col-7 mt-3">
            <div class="card rounded-3">
                <div class="card-header">
                    <div class="d-flex align-items-end rounded-5">
                        <div style="height: 54px; width: 60px;" class="bg-dark rounded-4">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="white" class="bi bi-calendar3 p-2" viewBox="0 0 16 16">
                                <path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857z"/>
                                <path d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
                            </svg>
                        </div>
                        <h1 class="card-title mx-3 text-center w-100">Asistencias a clases</h1>
                    </div>                    
                </div>
                
                <div class="card-body">
                    <!--CONSULTAR FECHAS DE ASISTENCIAS-->
                    <form action="/consultas/pagos/recuperar", method="post">
                        <div class="row pt-2">
                            <div class="col-8 offset-2">
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-receipt" viewBox="0 0 16 16">
                                            <path d="M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27m.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0z" />
                                            <path d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5m8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5" />
                                        </svg>
                                    </span>
                                    <span class="input-group-text">Asistencias del mes de </span>
                                    <input type="month" name="fecha" class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="row pt-2">
                            <div class="col-8 offset-2">
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                                            <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z" />
                                            <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466" />
                                        </svg>
                                    </span>
                                    <input type="submit" name="filter" class="form-control btn btn-outline-success" value="Buscar asistencias">
                                    <span class="input-group-text">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                                            <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z" />
                                            <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466" />
                                        </svg>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </form>

                    <hr>
                    
                    <div class="row pt-3">
                        <div class=" col-10 offset-1">
                            <h5 class="text-center fw-bold">Asistencias a clases de {{alumno.Nombres}} {{alumno.Ap_pat}} {{alumno.Ap_mat}}</h5>
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th scope="col">Fecha completa</th>
                                        <th scope="col">Día</th>
                                        <th scope="col">Horario</th>
                                    </tr>
                                </thead>
                                {% if alumnos | length > 0 %}
                                <tbody>
                                    {% for alumno in alumnos %}
                                    <tr style="cursor: pointer;">
                                        <td>{{ alumno.Nombres }}</td>
                                        <td>{{ alumno.Ap_pat }}</td>
                                        <td>{{ alumno.Ap_mat }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                                {% endif %}
                            </table>

                            {% if alumnos|length == 0 %}
                            <p class="text-center">Sin registros</p>
                            <hr>
                            {% endif %}
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
{% else %}
<h1>No hay alumno</h1>
{% endif %}

<script>
    
</script>

{% endblock %}